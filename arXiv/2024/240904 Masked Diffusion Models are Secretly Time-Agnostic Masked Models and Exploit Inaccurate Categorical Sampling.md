https://arxiv.org/abs/2409.02908

*Masked Diffusion Models are Secretly Time-Agnostic Masked Models and Exploit Inaccurate Categorical Sampling* (Kaiwen Zheng, Yongxin Chen, Hanzi Mao, Ming-Yu Liu, Jun Zhu, Qinsheng Zhang)

> Masked diffusion models (MDMs) have emerged as a popular research topic for generative modeling of discrete data, thanks to their superior performance over other discrete diffusion models, and are rivaling the auto-regressive models (ARMs) for language modeling tasks. The recent effort in simplifying the masked diffusion framework further leads to alignment with continuous-space diffusion models and more principled training and sampling recipes. In this paper, however, we reveal that both training and sampling of MDMs are theoretically free from the time variable, arguably the key signature of diffusion models, and are instead equivalent to masked models. The connection on the sampling aspect is drawn by our proposed first-hitting sampler (FHS). Specifically, we show that the FHS is theoretically equivalent to MDMs' original generation process while significantly alleviating the time-consuming categorical sampling and achieving a 20$\times$ speedup. In addition, our investigation challenges previous claims that MDMs can surpass ARMs in generative perplexity. We identify, for the first time, an underlying numerical issue, even with the 32-bit floating-point precision, which results in inaccurate categorical sampling. We show that the numerical issue lowers the effective temperature both theoretically and empirically, leading to unfair assessments of MDMs' generation results in the previous literature.

Masked Diffusion에 대한 연구. Optimal Maksed Diffusion은 시간에 Independent 하기 때문에 시간 입력을 줄 필요가 없을 수 있고 MaskGIT 같은 전통적인(?) Masked Model Objective를 쓸 수 있다는 것을 보였군요.

그리고 Masked Diffusion 모델이 Autoregresssive 모델보다 Perplexity가 낮으면서 동시에 엔트로피까지 낮은 이슈를 발견해서 확인해봤더니 수치 문제가 있었다고 합니다. 수치 문제를 해결했더니 엔트로피가 정상으로 돌아오는 동시에 Perplexity가 점프해버렸네요. 허무한 결과이긴 합니다.

일단 Masked Diffusion에 대해서는 좋지 않은 결과네요. 동시에 가장 단순한 생성 모델 중 하나인 Autoregressive 모델은 생각 이상으로 견고하군요.

#diffusion #autoregressive-model 